package com.aliensdecoder;

import android.text.SpannableStringBuilder;
import android.widget.EditText;

import unalcol.gui.editor.Tokenizer;

/**
 * Created by jgomez on 3/07/17.
 */

public class SyntaxEditText{
    private SyntaxTextWatcher watcher = null;
    private SpannableParagraph paragraph;
    private EditText input;

    public SyntaxEditText(EditText input){ this.input = input; }

    public void update( int start, int before, int count ){
        paragraph.update(start,before,count,(SpannableStringBuilder)input.getText());
    }

    public void locate( int row, int column ){
        input.setSelection(paragraph.offset(row,column));
    }

    public void setTokenizer(Tokenizer tokenizer, SpanFactory span_factory){
        if( watcher != null ) input.removeTextChangedListener(watcher);
        paragraph = new SpannableParagraph((SpannableStringBuilder)input.getText(),tokenizer,span_factory);
        watcher = new SyntaxTextWatcher(this, tokenizer, span_factory);
        input.addTextChangedListener(watcher);
    }

    public EditText input(){ return input; }

    public String getText(){ return input.getText().toString(); }

    public void setText( String str ){ input.setText(str); }
}
